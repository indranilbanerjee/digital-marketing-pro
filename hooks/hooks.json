{
  "hooks": {
    "SessionStart": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "(python ${CLAUDE_PLUGIN_ROOT}/scripts/setup.py --check-deps --summary || python3 ${CLAUDE_PLUGIN_ROOT}/scripts/setup.py --check-deps --summary || echo Digital Marketing Pro loaded) && (python ${CLAUDE_PLUGIN_ROOT}/scripts/guidelines-manager.py --brand $(python -c \"import json,pathlib;f=pathlib.Path.home()/'.claude-marketing'/'brands'/'_active-brand.json';print(json.loads(f.read_text())['active_slug'] if f.exists() else '')\" 2>/dev/null) --action summary 2>/dev/null || true)"
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "prompt",
            "command": "First, check the file path being written/edited. If the file is NOT inside a marketing plugin directory (skills/, agents/, scripts/, hooks/, .claude-plugin/) AND is NOT marketing deliverable content (ad copy, email content, social posts, blog articles, landing pages, press releases, or branded marketing content being created for the user), respond 'SKIP' immediately. Do NOT check files in the user's own project directories, config files, source code, or non-marketing outputs — those are always SKIP. Only proceed with the check if this IS marketing content being generated as part of a plugin workflow. In that case, and only if a brand profile exists, briefly verify: (1) content aligns with brand voice guidelines, (2) no industry compliance violations, (3) FTC disclosure included if this is influencer/sponsored content, (4) if brand guidelines exist at ~/.claude-marketing/brands/{slug}/guidelines/ — check restrictions.md for banned words and restricted claims in the content, flag violations with the specific rule and a suggested alternative. Keep the check concise — flag only real issues, not stylistic preferences. $ARGUMENTS"
          }
        ]
      },
      {
        "matcher": "mcp_.*",
        "hooks": [
          {
            "type": "prompt",
            "command": "Check if this MCP tool call involves a WRITE operation (creating, publishing, sending, updating, scheduling, or deleting content on an external platform — including CRM record creation, email sending, social posting, ad campaign creation, SMS sending, database writes, or file uploads). If this is a READ-ONLY operation (fetching data, querying analytics, listing items, searching), respond 'SKIP' immediately. For WRITE operations: (1) Verify the user has explicitly approved this specific action in the current conversation — look for clear approval language, (2) Check that content has passed brand compliance review if applicable, (3) Confirm the target platform matches the user's stated intent, (4) For ad campaigns: verify budget is within the brand's stated budget_range from profile.json, (5) For email/SMS: verify list size and consent compliance, (6) For CRM writes: verify data doesn't overwrite existing records without confirmation. If ANY check fails, BLOCK the operation and explain why. If all checks pass, respond 'ALLOW'. $ARGUMENTS"
          }
        ]
      }
    ],
    "SessionEnd": [
      {
        "hooks": [
          {
            "type": "prompt",
            "command": "If marketing work was done this session (campaign plans created, content produced, performance analyses run, strategic decisions made, or brand positioning discussed): 1. Summarize 1-3 key marketing insights or decisions from this session. 2. If an active brand exists (check the session start context for the brand slug), save each insight by running: python \"${CLAUDE_PLUGIN_ROOT}/scripts/campaign-tracker.py\" --brand {slug} --action save-insight --data '{\"type\":\"session_learning\",\"insight\":\"[the insight]\",\"source\":\"session\",\"context\":\"[what work produced this insight]\"}' — replace {slug} with the active brand slug, and fill in the insight and context fields with actual session data. 3. If any guideline violations were flagged during this session, save them by running: python \"${CLAUDE_PLUGIN_ROOT}/scripts/campaign-tracker.py\" --brand {slug} --action save-violation --data '{\"rule\":\"[violated rule]\",\"category\":\"[guideline category]\",\"severity\":\"[low/medium/high]\",\"content\":\"[violating text snippet]\",\"suggestion\":\"[compliant alternative]\"}' for each violation. 4. Tell the user: 'Session insights saved. Key takeaways: [list them]. To update brand settings, just ask.' If no brand profile exists or no meaningful marketing work was done, skip silently. $ARGUMENTS"
          }
        ]
      }
    ]
  }
}
